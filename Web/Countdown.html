<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Countdown</title>
		<style type="text/css">
			html, body, #Gamescreen {
				margin: 0;
				width: 100%;
				height: 100%;
            }
            html, body {
                background: black;
                overflow: hidden;
			}
            div, img {
                position: absolute;
            }
            #Gamescreen {
                background-image: url("Backdrop.png"), linear-gradient(to top, #FFF600, #F47705);
                background-size: 100% auto;
                background-repeat: no-repeat;
                background-position: 50% 100%;
            }
            #Overlay {
                margin: 0;
                left: 20%;
                width: 60%;
                top: 20%;
                height: 60%;
                background-color: #FFEBAF;
                border-style: solid;
                border-color: #A91800;
                border-radius: 5%;
                border-width: 10px;
            }
            #OverlayText {
                top: 10%;
                left: 10%;
                color: #6D0F00;
                font-size: 50px;
            }
            #OverlayCountdown {
                width: 100%;
                text-align: center;
                top: 45%; /* Fallback */
                top: calc(50% - 50px);
                color: #6D0F00;
                font-size: 100px;
            }
            #OverlayCity {
                top: 10%;
            }
		</style>
		<script type="text/javascript" src="jquery-1.8.3.min.js"></script>
		<script type="text/javascript">
            var FRAME_DELAY = 20.0; // Milliseconds
            var TRIAL_TIME = 5000.0; // Milliseconds
            
			window.onload = function() {
                ResetProjectiles();
                setTimeout(Tick, FRAME_DELAY);
			};
            
            /**
             * Places the aeroplane and the missile where they should start
             * before any trial should begin
             */
            ResetProjectiles = function() {
                $('#Aeroplane').css({
                    "left": "100%", 
                    "top": "15%", 
                });
                $('#Missile').css({
                    "left": "85%", 
                    "top": "100%", 
                });
            }
            
            /**
             * Game loop
             * Handles motion of projectiles
             */
            Tick = function() {
                var width = $('#Gamescreen').width() * 1.0;
                var height = $('#Gamescreen').height() * 1.0;
                
                // Move the aeroplane left
                // It should move off the screen over the trial time
                var aeroplane = $('#Aeroplane');
                var aeroplaneWidth = aeroplane.width();
                var aeroplanePos = aeroplane.position().left / width 
                                  - FRAME_DELAY / TRIAL_TIME
                                      * (1.0 + aeroplaneWidth / width);
                aeroplanePos *= 100; // Percent
                aeroplane.css({
                    "left": aeroplanePos + "%"
                });
                
                // Move the missile towards the city
                var missile = $('#Missile');
                var missileRad = parseFloat(missile.attr('radians'))
                                 + FRAME_DELAY / TRIAL_TIME
                                     * 1.5707963267948966192313216916398;
                missile.attr('radians', '' + missileRad);
                missile.css({
                    "left": (Math.cos(missileRad) * 85) + "%", 
                    "top": (100 - Math.sin(missileRad) * 85) + "%", 
                    "transform": "rotate(-" + missileRad + "rad)"
                });
                
                // Continue looping
                setTimeout(Tick, FRAME_DELAY);
            };
		</script>
	</head>
	<body tabindex="0">
        <div id="Gamescreen">
            <div id="Overlay">
                <div id="OverlayText">Countdown!</div>
                <div id="OverlayCountdown">-</div>
            </div>
            <div id="OverlayCity">
                <img src="City.png" alt="" />
            </div>
            <div id="Explosion">
                <img src="Explosion.png" alt="" />
            </div>
            <div id="Aeroplane">
                <img src="Airplane.png" alt="" />
            </div>
            <div id="Missile" radians="0.0">
                <img src="Missile.png" alt="" />
            </div>
        </div>
	</body>
</html>